import{l as g,A,W as F,m as ee,i as te,x as T,r as se,h as d,o as u,a,u as n,g as ae,w as j,b as t,t as m,S as oe,f as y,d as ne,j as le,F as D,z as $,y as ie}from"./app-BFIzMVFd.js";import{_ as re}from"./AuthenticatedLayout-C6jx-peY.js";import{_ as de}from"./SuccessFlash-K6L5X7l6.js";import{_ as ue}from"./ErrorFlash-HvhEktw7.js";import{_ as I}from"./InputError-CQqX-vWw.js";import{_ as N}from"./InputLabel-DrIpQjD0.js";import{_ as B}from"./TextInput-CMlNlbfd.js";import ge from"./SubKegiatanModal-Cy-Hppw9.js";import me from"./KegiatanCard-MttH6eAB.js";import ce from"./SubKegiatanList-ebf3k526.js";import fe from"./KegiatanModal-CdcyDWGy.js";import pe from"./NotaModal-B9tX486C.js";import he from"./LampiranModal-DgAVUKvQ.js";import be from"./DeleteNotaModal-08rBUgk3.js";import ve from"./ProgramModal-BL1hKzBQ.js";import xe from"./DeleteProgramModal-DpjhCHsD.js";import{f as h}from"./formatters--Bkvj4ca.js";import{_ as we}from"./SearchInput-D6kPj4dm.js";import"./Modal-By5cnOVT.js";import"./PrimaryButton-DMpJWd03.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SecondaryButton-B7RMHXRj.js";import"./DangerButton-DalIR-J_.js";import"./Tooltip-CKiwYQvw.js";const _e={class:"pt-6 sm:pt-24 mx-2 sm:px-2 space-y-4"},ke={class:"max-w-8xl mx-auto lg:px-6"},ye={class:"bg-gradient-to-br from-indigo-600 to-blue-500 text-white rounded-lg p-6 shadow-md flex flex-col sm:flex-row justify-between items-start sm:items-center"},Se={class:"text-2xl font-bold"},Ee={class:"grid grid-cols-1 md:grid-cols-3 gap-4 lg:px-6"},Ke={class:"bg-white shadow rounded-lg p-4 flex items-center border-l-4 border-l-green-600"},De={class:"text-lg font-semibold text-red-600"},Pe={class:"bg-white shadow rounded-lg p-4 flex items-center border-l-4 border-l-blue-700"},Ce={class:"text-lg font-semibold text-green-700"},$e={class:"bg-white shadow rounded-lg p-4 flex items-center border-l-4 border-l-red-700"},Ne={class:"text-lg font-semibold text-blue-700"},Ve={class:"max-w-8xl mx-auto lg:px-6"},Me={class:"bg-white rounded-lg shadow-md p-4"},Ae={class:"flex justify-between items-center mb-4"},Fe={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Te=["value"],je={class:"md:col-span-1"},Ie={class:"flex justify-end"},Be=["disabled"],Re={class:"max-w-8xl mx-auto lg:px-6"},Ue={class:"bg-white rounded-lg shadow-md p-4"},Ye={class:"space-y-8 lg:px-6 pb-1"},He={key:0},Oe={class:"flex items-center justify-between mb-4"},We={class:"text-xl font-bold text-indigo-700 flex items-center"},qe={class:"flex space-x-2"},ze=["onClick"],Le=["onClick"],Ge={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},Je={class:"bg-white shadow rounded-lg p-3 flex items-center border-l-4 border-l-green-500"},Qe={class:"text-md font-semibold text-red-500"},Xe={class:"bg-white shadow rounded-lg p-3 flex items-center border-l-4 border-l-blue-600"},Ze={class:"text-md font-semibold text-green-600"},et={class:"bg-white shadow rounded-lg p-3 flex items-center border-l-4 border-l-red-600"},tt={class:"text-md font-semibold text-blue-600"},st={class:"space-y-6"},at={key:0},ot={key:1,class:"text-gray-500 text-center py-4"},nt={key:1,class:"text-gray-600 text-center py-8 text-lg bg-white rounded-lg shadow-md"},$t={__name:"SkpdDetail",props:{skpd:Object,tahunSelected:Number,rekap:Object},setup(r){const P=r,C=g("");A(C,s=>{F.get(route("skpds.show",P.skpd.id),{search:s},{preserveState:!0,replace:!0})});const R=ee(),S=te(()=>R.props.flash||{}),V=()=>{S.value.success=null,S.value.error=null},l=T({program_id:null,nama:"",tahun_anggaran:new Date().getFullYear()});function U(){if(!l.program_id){alert("Pilih program terlebih dahulu.");return}l.post(route("kegiatans.store",{skpd:P.skpd.id}),{preserveScroll:!0,onSuccess:()=>{l.reset("program_id","nama"),l.program_id=null,p()}})}const w=g({});A(()=>P.skpd.programs,s=>{s&&Array.isArray(s)&&s.forEach(e=>{e.kegiatans&&Array.isArray(e.kegiatans)&&e.kegiatans.forEach(i=>{w.value[i.id]||(w.value[i.id]=T({kode_rekening:"",nama:"",pagu:"",tahun_anggaran:new Date().getFullYear()}))})})},{immediate:!0,deep:!0});function Y(s){w.value[s].post(route("subkegiatans.store",s),{preserveScroll:!0,onSuccess:()=>{w.value[s].reset(),p()}})}const b=g({show:!1,isEditing:!1,program:null}),E=g({show:!1,program:null}),f=g({show:!1,isEditing:!1,subKegiatan:null,kegiatan:null}),v=g({show:!1,isEditing:!1,kegiatan:null}),c=g({show:!1,isEditing:!1,subKegiatan:null,notaDinas:null}),_=g({show:!1,notaId:null}),K=g({show:!1,notaDinas:null}),H=()=>{b.value={show:!0,isEditing:!1,program:null}},O=s=>{b.value={show:!0,isEditing:!0,program:s}},W=s=>{E.value={show:!0,program:s}},q=s=>{v.value={show:!0,isEditing:!0,kegiatan:s}},z=s=>{v.value={show:!0,isEditing:!1,kegiatan:s}},L=(s,e)=>{f.value={show:!0,isEditing:!0,subKegiatan:s,kegiatan:e}},G=(s,e)=>{f.value={show:!0,isEditing:!1,subKegiatan:s,kegiatan:e}},J=s=>{c.value={show:!0,isEditing:!1,subKegiatan:s,notaDinas:null}},Q=(s,e)=>{c.value={show:!0,isEditing:!0,subKegiatan:e,notaDinas:s}},X=s=>{_.value={show:!0,notaId:s.id}},Z=s=>{K.value={show:!0,notaDinas:s}},k=s=>{switch(s){case"program":b.value.show=!1;break;case"deleteProgram":E.value.show=!1;break;case"nota":c.value.show=!1;break;case"attachment":_.value.show=!1,_.value.notaId=null;break;case"delete":K.value.show=!1;break}},p=()=>{F.reload({only:["skpd"]})};return(s,e)=>{const i=se("font-awesome-icon");return u(),d(D,null,[a(n(ae),{title:"Capaian SKPD"}),a(re,null,{default:j(()=>{var M;return[a(de,{flash:S.value,onClearFlash:V},null,8,["flash"]),a(ue,{flash:S.value,onClearFlash:V},null,8,["flash"]),t("div",_e,[t("div",ke,[t("div",ye,[t("div",null,[t("h2",Se,m(r.skpd.nama_skpd),1)]),a(n(oe),{href:s.route("skpds.tahun",{skpd:r.skpd.id,tahun:new Date().getFullYear()}),class:"bg-blue-200 text-blue-800 hover:text-white text-sm font-medium px-3 py-1 rounded-full hover:bg-blue-800 transition-colors"},{default:j(()=>e[11]||(e[11]=[y(" Histori ")])),_:1},8,["href"])])]),t("div",Ee,[t("div",Ke,[a(i,{icon:["fas","money-bill-wave"],class:"text-green-600 text-2xl mr-3"}),t("div",null,[e[12]||(e[12]=t("p",{class:"text-sm text-gray-500"},"Total Pagu SKPD",-1)),t("p",De," Rp. "+m(n(h)(r.rekap.totalPagu)),1)])]),t("div",Pe,[a(i,{icon:["fas","money-bill-trend-up"],class:"text-blue-700 text-2xl mr-3"}),t("div",null,[e[13]||(e[13]=t("p",{class:"text-sm text-gray-500"},"Total Serapan SKPD",-1)),t("p",Ce," Rp. "+m(n(h)(r.rekap.totalSerapan)),1)])]),t("div",$e,[a(i,{icon:["fas","percent"],class:"text-red-700 text-2xl mr-3"}),t("div",null,[e[14]||(e[14]=t("p",{class:"text-sm text-gray-500"},"Persentase Serapan SKPD",-1)),t("p",Ne,m(n(h)(r.rekap.persentaseSerapan))+"% ",1)])])]),t("div",Ve,[t("div",Me,[t("div",Ae,[e[16]||(e[16]=t("h3",{class:"text-lg font-semibold text-gray-800 mb-4"}," Tambah Kegiatan Baru ",-1)),t("button",{onClick:H,class:"inline-flex items-center px-2 py-1.5 bg-green-500 border border-transparent rounded-md font-semibold text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors"},[a(i,{icon:["fas","plus"],class:"mr-2"}),e[15]||(e[15]=y(" Tambah Program "))])]),t("form",{onSubmit:ne(U,["prevent"]),class:"space-y-4"},[t("div",Fe,[t("div",null,[a(N,{for:"program_id",value:"Pilih Program"}),le(t("select",{id:"program_id","onUpdate:modelValue":e[0]||(e[0]=o=>n(l).program_id=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},[e[17]||(e[17]=t("option",{value:null,selected:"",disabled:""},"-- Pilih Program --",-1)),(u(!0),d(D,null,$(r.skpd.programs,o=>(u(),d("option",{key:o.id,value:o.id},m(o.nama),9,Te))),128))],512),[[ie,n(l).program_id]]),a(I,{message:n(l).errors.program_id},null,8,["message"])]),t("div",je,[a(N,{for:"nama-kegiatan",value:"Nama Kegiatan"}),a(B,{id:"nama-kegiatan",modelValue:n(l).nama,"onUpdate:modelValue":e[1]||(e[1]=o=>n(l).nama=o),class:"w-full",placeholder:"Masukkan nama kegiatan"},null,8,["modelValue"]),a(I,{message:n(l).errors.nama},null,8,["message"])]),t("div",null,[a(N,{for:"tahun-anggaran-kegiatan",value:"Tahun Anggaran"}),a(B,{id:"tahun-anggaran-kegiatan",modelValue:n(l).tahun_anggaran,"onUpdate:modelValue":e[2]||(e[2]=o=>n(l).tahun_anggaran=o),class:"w-full",readonly:""},null,8,["modelValue"])])]),t("div",Ie,[t("button",{type:"submit",disabled:n(l).processing||!n(l).program_id,class:"inline-flex items-center px-3 py-1.5 bg-indigo-500 border border-transparent rounded-md font-semibold text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," Simpan ",8,Be)])],32)])]),t("div",Re,[t("div",Ue,[a(we,{search:C.value,"onUpdate:search":e[3]||(e[3]=o=>C.value=o),class:"pt-2",placeholder:"Cari sub kegiatan..."},null,8,["search"])])]),t("div",Ye,[r.skpd.programs&&r.skpd.programs.length>0?(u(),d("div",He,[(u(!0),d(D,null,$(r.skpd.programs,o=>(u(),d("div",{key:o.id,class:"bg-gray-50 p-4 rounded-lg shadow-sm border border-gray-200 mb-4"},[t("div",Oe,[t("h3",We,[a(i,{icon:["fas","folder-open"],class:"mr-2"}),y(" "+m(o.nama),1)]),t("div",qe,[t("button",{onClick:x=>O(o),class:"inline-flex items-center px-3 py-1 bg-yellow-500 border border-transparent rounded-md font-semibold text-white text-sm hover:bg-yellow-600 focus:outline-none focus:ring-2 focus:ring-yellow-500 transition-colors"},[a(i,{icon:["fas","edit"],class:"mr-1"}),e[18]||(e[18]=y(" Edit "))],8,ze),t("button",{onClick:x=>W(o),class:"inline-flex items-center px-3 py-1 bg-red-500 border border-transparent rounded-md font-semibold text-white text-sm hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors"},[a(i,{icon:["fas","trash"],class:"mr-1"}),e[19]||(e[19]=y(" Hapus "))],8,Le)])]),t("div",Ge,[t("div",Je,[a(i,{icon:["fas","coins"],class:"text-green-500 text-xl mr-2"}),t("div",null,[e[20]||(e[20]=t("p",{class:"text-xs text-gray-500"},"Pagu Program",-1)),t("p",Qe," Rp. "+m(n(h)(o.pagu)),1)])]),t("div",Xe,[a(i,{icon:["fas","sack-dollar"],class:"text-blue-600 text-xl mr-2"}),t("div",null,[e[21]||(e[21]=t("p",{class:"text-xs text-gray-500"},"Serapan Program",-1)),t("p",Ze," Rp. "+m(n(h)(o.total_serapan)),1)])]),t("div",et,[a(i,{icon:["fas","chart-pie"],class:"text-red-600 text-xl mr-2"}),t("div",null,[e[22]||(e[22]=t("p",{class:"text-xs text-gray-500"},"Persentase Serapan Program",-1)),t("p",tt,m(n(h)(o.presentase_serapan))+"% ",1)])])]),t("div",st,[o.kegiatans&&o.kegiatans.length>0?(u(),d("div",at,[(u(!0),d(D,null,$(o.kegiatans,x=>(u(),d("div",{key:x.id,class:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-100 mb-4"},[a(me,{kegiatan:x,onEdit:q,onDelete:z},null,8,["kegiatan"]),a(ce,{kegiatan:x,formSubKegiatan:w.value[x.id],formatNumber:n(h),onSubmit:Y,onEdit:L,onDelete:G,onCreateNotaDinas:J,onEditNota:Q,onDeleteNota:Z,onViewAttachment:X},null,8,["kegiatan","formSubKegiatan","formatNumber"])]))),128))])):(u(),d("div",ot," Tidak ada kegiatan untuk program ini "))])]))),128))])):(u(),d("div",nt," Tidak ada program yang tersedia untuk SKPD ini "))])]),a(ve,{show:b.value.show,isEditing:b.value.isEditing,program:b.value.program,skpdId:r.skpd.id,onClose:e[4]||(e[4]=()=>k("program")),onSuccess:p},null,8,["show","isEditing","program","skpdId"]),a(xe,{show:E.value.show,program:E.value.program,onClose:e[5]||(e[5]=()=>k("deleteProgram")),onSuccess:p},null,8,["show","program"]),a(fe,{show:v.value.show,isEditing:v.value.isEditing,kegiatan:v.value.kegiatan,onClose:e[6]||(e[6]=o=>v.value.show=!1),onSuccess:p},null,8,["show","isEditing","kegiatan"]),a(ge,{show:f.value.show,subKegiatan:f.value.subKegiatan,isEditing:f.value.isEditing,kegiatan:f.value.kegiatan,onClose:e[7]||(e[7]=o=>f.value.show=!1),onSuccess:p},null,8,["show","subKegiatan","isEditing","kegiatan"]),a(pe,{show:c.value.show,isEdit:c.value.isEditing,notaData:c.value.notaDinas,subKegiatan:c.value.subKegiatan||((M=c.value.notaDinas)==null?void 0:M.sub_kegiatan),onClose:e[8]||(e[8]=()=>k("nota")),onSuccess:p},null,8,["show","isEdit","notaData","subKegiatan"]),a(he,{show:_.value.show,notaId:_.value.notaId,onClose:e[9]||(e[9]=()=>k("attachment"))},null,8,["show","notaId"]),a(be,{show:K.value.show,notaDinas:K.value.notaDinas,onClose:e[10]||(e[10]=()=>k("delete"))},null,8,["show","notaDinas"])]}),_:1})],64)}}};export{$t as default};
