import{_ as w}from"./Modal-By5cnOVT.js";import{l as i,A as D,p as j,h as a,o as s,a as x,w as y,b as t,e as b,t as d,F as g,z as A,f as B}from"./app-BFIzMVFd.js";const M={class:"rounded-lg shadow-lg p-6 w-full"},V={class:"list-disc pl-5 text-sm text-gray-700"},S={key:0,class:"text-gray-500"},T={key:1,class:"text-red-500"},$={key:2,class:"text-gray-500"},q=["onClick"],E={class:"text-gray-500 text-xs"},P={class:"h-dvh p-6 flex flex-col"},z={class:"flex justify-between items-center mb-4"},G={class:"text-lg font-semibold"},W={class:"flex-1 overflow-hidden"},H=["src"],Q={__name:"LampiranModal",props:{show:{type:Boolean,required:!0},notaId:{type:[Number,String],required:!1}},emits:["close"],setup(f,{emit:k}){const l=f,C=k,c=i([]),m=i(!1),u=i(null),o=i(null),h=i(null);D(()=>l.show,e=>{e&&p()}),j(()=>{l.show&&p()});const _=()=>{C("close"),h.value=null},v=()=>{o.value=null},I=e=>{o.value=e},F=e=>new Date(e).toLocaleString("id-ID");async function p(){if(!l.notaId){console.warn("Nota ID tidak tersedia!");return}h.value!==l.notaId&&(await L(),h.value=l.notaId)}async function L(){m.value=!0,u.value=null,c.value=[];try{const e=await fetch(`/nota/lampiran/${l.notaId}`);if(!e.ok)throw new Error("Gagal memuat lampiran");const r=await e.json();c.value=Array.isArray(r.data)?r.data:[]}catch(e){u.value=e.message||"Terjadi kesalahan"}finally{m.value=!1}}return(e,r)=>(s(),a(g,null,[x(w,{show:f.show,onClose:_},{default:y(()=>[t("div",M,[t("div",{class:"flex justify-between items-center border-b pb-3 mb-4"},[r[0]||(r[0]=t("h2",{class:"text-lg font-semibold text-gray-800"},"Daftar Lampiran",-1)),t("button",{onClick:_},"✖")]),t("ul",V,[m.value?(s(),a("li",S,"Memuat lampiran...")):u.value?(s(),a("li",T,d(u.value),1)):c.value.length===0?(s(),a("li",$,"Tidak ada lampiran.")):b("",!0),(s(!0),a(g,null,A(c.value,(n,N)=>(s(),a("li",{key:N,class:"mb-2 cursor-pointer text-blue-600 hover:underline",onClick:J=>I(n)},[B(d(n.name)+" ",1),t("span",E," ("+d(F(n.created_at))+")",1)],8,q))),128))])])]),_:1},8,["show"]),x(w,{show:!!o.value,onClose:v,maxWidth:"fullscreen"},{default:y(()=>{var n;return[t("div",P,[t("div",z,[t("h3",G,d((n=o.value)==null?void 0:n.name),1),t("button",{onClick:v},"✖")]),t("div",W,[o.value?(s(),a("iframe",{key:0,src:o.value.url,class:"w-full h-full border-0 bg-white",frameborder:"0"},null,8,H)):b("",!0)])])]}),_:1},8,["show"])],64))}};export{Q as default};
